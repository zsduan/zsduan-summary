var e=Object.defineProperty,s=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,l=(s,t,r)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,a=(e,a)=>{for(var i in a||(a={}))t.call(a,i)&&l(e,i,a[i]);if(s)for(var i of s(a))r.call(a,i)&&l(e,i,a[i]);return e};import{r as i,u as o}from"./_xlsx@0.18.5@xlsx.751d861d.js";import{n}from"../static/js/index-3480c9ab.js";import"./_vue@2.6.11@vue.018c1e04.js";import"./_async-validator@1.8.5@async-validator.e65fb9e0.js";import"./_babel-runtime@6.26.0@babel-runtime.fd39bdc3.js";import"./_core-js@2.6.12@core-js.a6b1d284.js";import"./_vue-router@3.6.5@vue-router.8819c4a8.js";import"./_vuex@3.6.2@vuex.6ec484f5.js";import"./_element-ui@2.15.12@element-ui.07608cd3.js";import"./_deepmerge@1.5.2@deepmerge.fba82243.js";import"./_resize-observer-polyfill@1.5.1@resize-observer-polyfill.5c8b5044.js";import"./_throttle-debounce@1.1.0@throttle-debounce.2739eac7.js";import"./_lodash@4.17.21@lodash.90986bd2.js";import"./_babel-helper-vue-jsx-merge-props@2.0.3@babel-helper-vue-jsx-merge-props.79de6b76.js";import"./_normalize-wheel@1.0.1@normalize-wheel.6188a64d.js";import"./_mavon-editor@2.10.4@mavon-editor.3db41916.js";import"./_vue-prism-editor@1.3.0@vue-prism-editor.705c8dca.js";import"./_prismjs@1.29.0@prismjs.9fa8e4a1.js";const m={props:{newIndex:{type:Boolean,default:()=>!1}},data:()=>({xlsxInfo:{},code1:'\n/*\n * @name 读取 xlsx 和 excel\n * @parame fileId 读取文件的 id 可选 fileId/file/refs 任选其一\n * @parame file 文件本身 可选 fileId/file/refs 任选其一\n * @parame refs vue的ref 可选 fileId/file/refs 任选其一\n * @parame _this 全局的this指向 refs不为空可选\n * @method fail 错误返回\n * @method success 成功返回 返回数据为下面的数据\n * @desc 中文文档地址 https://github.com/rockboom/SheetJS-docs-zh-CN\n * @desc 更加强大 可以做在线编辑的 https://github.com/exceljs/exceljs/blob/master/README_zh.md\n * @return xlsxList = {\n            data : {}, //json数据\n            html : {}, //展示的html\n            cvs : {}, // cvs\n            formulae : {}, //生成公式列表(带有值回退)。\n            TextUtf16 : {}, // 文字 utf16\n            xlsxname : files.name,\n            sheet_name : [],\n        };\n*/ \nimport {readeXlsx} from "@/utils/readeXlsx"\n// 使用方法\nreadeXlsx({\n    refs : "myfile",\n    _this : this,\n    success:(res) =>{\n        this.xlsxInfo = res;\n    },\n    fail : (e)=>{\n        console.log(e);\n    }\n})\n'}),methods:{changeFile(){((e,...s)=>{let t={fileId:"",file:"",refs:"",success:e=>{},fail:e=>{}};if(t=a(a({},t),s[0]),!t.fileId&&!t.file&&!t.refs)return void t.fail({code:-1,msg:"fileId or file or refs must be not null"});if(t.refs&&!e)return void t.fail({code:-1,msg:"_this must be not null"});let r=null;t.refs&&(r=e.$refs[t.refs].files[0]),t.fileId&&(r=document.querySelector(`#${t.fileId}`).files[0]),t.file&&(r=data.file);let l=r.name.substr(r.name.lastIndexOf("."));if(".xls"!=l&&".xlsx"!=l)return void t.fail({code:-1,msg:"Please upload xls and xlsx files"});const n=new FileReader;n.readAsBinaryString(r),n.onload=()=>{let e=n.result,s=i(e,{type:"binary"}),l={data:{},html:{},cvs:{},formulae:{},TextUtf16:{},xlsxname:r.name,sheet_name:[],code:200,msg:"success"};for(let t=0;t<s.SheetNames.length;t++){let e=!1;for(const r in s.Sheets[s.SheetNames[t]])Object.hasOwnProperty.call(s.Sheets[s.SheetNames[t]],r)&&"!ref"==r&&(e=!0);e&&(l.data[s.SheetNames[t]]=o.sheet_to_json(s.Sheets[s.SheetNames[t]]),l.cvs[s.SheetNames[t]]=o.sheet_to_csv(s.Sheets[s.SheetNames[t]]),l.html[s.SheetNames[t]]=o.sheet_to_html(s.Sheets[s.SheetNames[t]]),l.formulae[s.SheetNames[t]]=o.sheet_to_formulae(s.Sheets[s.SheetNames[t]]),l.TextUtf16[s.SheetNames[t]]=o.sheet_to_txt(s.Sheets[s.SheetNames[t]]),l.sheet_name.push(s.SheetNames[t]))}t.success(l)}})(this,{refs:"myfile",success:e=>{this.xlsxInfo=e},fail:e=>{console.log(e)}})}}},f={};var c=n(m,(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[e.newIndex?e._e():t("dzs-header",{attrs:{title:"xlsx/excel读取"}}),t("div",{staticClass:"page"},[t("div",{staticClass:"tips-box"},[e._v("目前只支持纯文本模式 其他模式暂时不支持")]),t("h2",[e._v("基础用法")]),t("div",{staticClass:"item"},[t("input",{ref:"myfile",attrs:{type:"file",accept:".xls,.xlsx"},on:{change:e.changeFile}}),t("div",[t("div",{staticClass:"title"},[e._v("预览")]),e._l(e.xlsxInfo.html,(function(s,r){return t("div",{key:r},[t("div",{staticClass:"table_name"},[e._v("预览名称 "+e._s(e.xlsxInfo.xlsxname)+" - "+e._s(r))]),t("div",{staticClass:"views-box",domProps:{innerHTML:e._s(s)}})])}))],2),t("div",{staticClass:"show-info-box"},[t("div",[e._v(e._s(e.xlsxInfo))])]),t("dzs-code",{attrs:{title:"源代码",value:e.code1}})],1),t("h2",[e._v("源代码下载/查看")]),e._m(0)]),e.newIndex?e._e():t("el-backtop",{attrs:{"visibility-height":20}})],1)}),[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"item"},[t("a",{attrs:{target:"_blank",href:"https://github.com/zsduan/zsduan-summary/blob/master/src/utils/readeXlsx.js"}},[e._v("下载/查看地址")])])}],!1,d,"6c60bb9c",null,null);function d(e){for(let s in f)this[s]=f[s]}var h=function(){return c.exports}();export{h as default};
