import{t as e}from"./_tinymce@5.10.7@tinymce.cab7f14e.js";import{E as t}from"./_@tinymce_tinymce-vue@3.2.8@@tinymce.16546234.js";import{n as i}from"../static/js/index-3480c9ab.js";const a={name:"dzs-editors",model:{prop:"value",event:"update:value"},props:{height:{type:Number|String,default:()=>500},value:{type:String,default:()=>""},width:{type:String,default:()=>"100%"},show_save:{type:Boolean,default:()=>!0},placeholder:{type:String,default:()=>"请输入内容"},production_url:{type:String,default:()=>"/zsduan-summary"},plugins:{type:String,default:()=>"copy cut paste print link code table lists wordcount image media save searchreplace insertdatetime hr preview importword autosave fullscreen print help"},toolbar:{type:Array,default:()=>["undo redo save| formatselect | fontsizeselect | fontselect | bold italic forecolor backcolor | alignleft aligncenter alignright alignjustify | lists image searchreplace | bullist numlist outdent indent |  media table insertdatetime | removeformat hr | importword autosave fullscreen print help"]}},components:{editor:t},data:()=>({editConfig:{},editValue:"",is_save_now:!0,showEdit:!1}),created(){let t=this;this.editConfig={language_url:this.production_url+"/tinymce/langs/zh_CN.js",language:"zh_CN",skin_url:this.production_url+"/tinymce/skins/ui/oxide",browser_spellcheck:!0,branding:!1,height:this.height||500,branding:!1,menubar:!0,file_picker_types:"image",images_upload_credentials:!0,placeholder:this.placeholder,autosave_interval:"20s",fontsize_formats:"14px 16px 18px 20px 24px 26px 28px 30px 32px 36px",font_formats:"微软雅黑=Microsoft YaHei,Helvetica Neue;PingFang SC;sans-serif;苹果苹方=PingFang SC,Microsoft YaHei,sans-serif;宋体=simsun;serifsans-serif;Terminal=terminal;monaco;Times New Roman=times new roman;times",plugins:this.plugins,toolbar:this.toolbar,importword_handler:function(e,t,i){var a=t[0].name;"docx"==a.substr(a.lastIndexOf(".")+1)?(e.notificationManager.open({text:"正在转换中...",type:"info",closeButton:!1}),i(t)):e.notificationManager.open({text:"目前仅支持docx文件格式，若为doc，请将扩展名改为docx",type:"warning"})},urlconverter_callback:(t,i,a,n)=>("img"===i&&t.startsWith("blob:")&&e.activeEditor&&e.activeEditor.uploadImages(),t),images_upload_handler:function(e,i,a){let n=new FormData;n.append("file",e.blob()),t.$api.editorProfileImg(n).then((e=>{i(e.path+e.url)})).catch((e=>{editor(e)}))},save_onsavecallback:function(){t.save()},init_instance_callback:e=>{e.on("change",(()=>{t.is_save_now&&t.save()}))}},this.editValue=this.value,setTimeout((()=>{this.showEdit=!0}),50)},watch:{value:{handler(e){this.editValue=e||"",this.$nextTick((()=>{var e=document.querySelector(".tox-edit-area__iframe");e&&this.keepLastIndex(e.contentWindow.document.getElementById("tinymce"),e.contentWindow)}))},immediate:!0,deep:!0}},methods:{save(){this.$emit("update:value",this.editValue),this.$emit("save",this.editValue)},keepLastIndex(e,t){if(t.getSelection)e.focus(),(i=t.getSelection()).selectAllChildren(e),i.collapseToEnd();else if(document.selection){var i;(i=document.selection.createRange()).moveToElementText(e),i.collapse(!1),i.select()}}}},n={};var s=i(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.showEdit?i("div",{style:e.width},[e.show_save?i("div",{staticClass:"sava-box"},[e._m(0),i("div",{staticClass:"item"},[i("span",[e._v("开启实时保存")]),e._v("： "),i("el-switch",{model:{value:e.is_save_now,callback:function(t){e.is_save_now=t},expression:"is_save_now"}})],1)]):e._e(),i("editor",{attrs:{init:e.editConfig},model:{value:e.editValue,callback:function(t){e.editValue=t},expression:"editValue"}})],1):e._e()])}),[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"item tips"},[i("span",[e._v("实时保存仅限输入 其他操作组件不保证实时保存 请自行点击保存")])])}],!1,o,"31bf14ca",null,null);function o(e){for(let t in n)this[t]=n[t]}var l=function(){return s.exports}();export{l as d};
