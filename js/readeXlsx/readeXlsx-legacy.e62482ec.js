!function(){function e(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function t(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?e(Object(r),!0).forEach((function(e){s(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function s(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var n=document.createElement("style");n.innerHTML=".show-info-box[data-v-6c60bb9c]{max-height:400px;overflow-y:scroll;margin-top:20px}.views-box[data-v-6c60bb9c]{margin:10px 0;border:1px solid #ccc;padding:10px}\n",document.head.appendChild(n),System.register(["../_xlsx@0.18.5@xlsx-legacy/_xlsx@0.18.5@xlsx.4e06a3a9.js","../../static/js/index-legacy-4f5f4a53.js","../_vue@2.6.11@vue-legacy/_vue@2.6.11@vue.841ea4d1.js","../_async-validator@1.8.5@async-validator-legacy/_async-validator@1.8.5@async-validator.7dd80777.js","../_babel-runtime@6.26.0@babel-runtime-legacy/_babel-runtime@6.26.0@babel-runtime.ad830da6.js","../_core-js@2.6.12@core-js-legacy/_core-js@2.6.12@core-js.fb62dcae.js","../_vue-router@3.6.5@vue-router-legacy/_vue-router@3.6.5@vue-router.83f42fa2.js","../_vuex@3.6.2@vuex-legacy/_vuex@3.6.2@vuex.d925beb9.js","../_element-ui@2.15.12@element-ui-legacy/_element-ui@2.15.12@element-ui.d28eec3b.js","../_deepmerge@1.5.2@deepmerge-legacy/_deepmerge@1.5.2@deepmerge.4bb7376b.js","../_resize-observer-polyfill@1.5.1@resize-observer-polyfill-legacy/_resize-observer-polyfill@1.5.1@resize-observer-polyfill.70aaf03b.js","../_throttle-debounce@1.1.0@throttle-debounce-legacy/_throttle-debounce@1.1.0@throttle-debounce.14bdd61a.js","../_lodash@4.17.21@lodash-legacy/_lodash@4.17.21@lodash.663713e6.js","../_babel-helper-vue-jsx-merge-props@2.0.3@babel-helper-vue-jsx-merge-props-legacy/_babel-helper-vue-jsx-merge-props@2.0.3@babel-helper-vue-jsx-merge-props.249d752d.js","../_normalize-wheel@1.0.1@normalize-wheel-legacy/_normalize-wheel@1.0.1@normalize-wheel.25f995f7.js","../_mavon-editor@2.10.4@mavon-editor-legacy/_mavon-editor@2.10.4@mavon-editor.c54f996c.js","../_vue-prism-editor@1.3.0@vue-prism-editor-legacy/_vue-prism-editor@1.3.0@vue-prism-editor.fcf380ad.js","../_prismjs@1.29.0@prismjs-legacy/_prismjs@1.29.0@prismjs.9136df25.js"],(function(e){"use strict";var s,n,r;return{setters:[function(e){s=e.r,n=e.u},function(e){r=e.n},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){}],execute:function(){var i={props:{newIndex:{type:Boolean,default:function(){return!1}}},data:function(){return{xlsxInfo:{},code1:'\n/*\n * @name 读取 xlsx 和 excel\n * @parame fileId 读取文件的 id 可选 fileId/file/refs 任选其一\n * @parame file 文件本身 可选 fileId/file/refs 任选其一\n * @parame refs vue的ref 可选 fileId/file/refs 任选其一\n * @parame _this 全局的this指向 refs不为空可选\n * @method fail 错误返回\n * @method success 成功返回 返回数据为下面的数据\n * @desc 中文文档地址 https://github.com/rockboom/SheetJS-docs-zh-CN\n * @desc 更加强大 可以做在线编辑的 https://github.com/exceljs/exceljs/blob/master/README_zh.md\n * @return xlsxList = {\n            data : {}, //json数据\n            html : {}, //展示的html\n            cvs : {}, // cvs\n            formulae : {}, //生成公式列表(带有值回退)。\n            TextUtf16 : {}, // 文字 utf16\n            xlsxname : files.name,\n            sheet_name : [],\n        };\n*/ \nimport {readeXlsx} from "@/utils/readeXlsx"\n// 使用方法\nreadeXlsx({\n    refs : "myfile",\n    _this : this,\n    success:(res) =>{\n        this.xlsxInfo = res;\n    },\n    fail : (e)=>{\n        console.log(e);\n    }\n})\n'}},methods:{changeFile:function(){var e=this;!function(e){var r={fileId:"",file:"",refs:"",success:function(e){},fail:function(e){}};if((r=t(t({},r),arguments.length<=1?void 0:arguments[1])).fileId||r.file||r.refs)if(!r.refs||e){var i=null;r.refs&&(i=e.$refs[r.refs].files[0]),r.fileId&&(i=document.querySelector("#".concat(r.fileId)).files[0]),r.file&&(i=data.file);var l=i.name.substr(i.name.lastIndexOf("."));if(".xls"==l||".xlsx"==l){var a=new FileReader;a.readAsBinaryString(i),a.onload=function(){for(var e=a.result,t=s(e,{type:"binary"}),l={data:{},html:{},cvs:{},formulae:{},TextUtf16:{},xlsxname:i.name,sheet_name:[],code:200,msg:"success"},o=0;o<t.SheetNames.length;o++){var c=!1;for(var f in t.Sheets[t.SheetNames[o]])Object.hasOwnProperty.call(t.Sheets[t.SheetNames[o]],f)&&"!ref"==f&&(c=!0);c&&(l.data[t.SheetNames[o]]=n.sheet_to_json(t.Sheets[t.SheetNames[o]]),l.cvs[t.SheetNames[o]]=n.sheet_to_csv(t.Sheets[t.SheetNames[o]]),l.html[t.SheetNames[o]]=n.sheet_to_html(t.Sheets[t.SheetNames[o]]),l.formulae[t.SheetNames[o]]=n.sheet_to_formulae(t.Sheets[t.SheetNames[o]]),l.TextUtf16[t.SheetNames[o]]=n.sheet_to_txt(t.Sheets[t.SheetNames[o]]),l.sheet_name.push(t.SheetNames[o]))}r.success(l)}}else r.fail({code:-1,msg:"Please upload xls and xlsx files"})}else r.fail({code:-1,msg:"_this must be not null"});else r.fail({code:-1,msg:"fileId or file or refs must be not null"})}(this,{refs:"myfile",success:function(t){e.xlsxInfo=t},fail:function(e){console.log(e)}})}}},l={},a=r(i,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.newIndex?e._e():s("dzs-header",{attrs:{title:"xlsx/excel读取"}}),s("div",{staticClass:"page"},[s("div",{staticClass:"tips-box"},[e._v("目前只支持纯文本模式 其他模式暂时不支持")]),s("h2",[e._v("基础用法")]),s("div",{staticClass:"item"},[s("input",{ref:"myfile",attrs:{type:"file",accept:".xls,.xlsx"},on:{change:e.changeFile}}),s("div",[s("div",{staticClass:"title"},[e._v("预览")]),e._l(e.xlsxInfo.html,(function(t,n){return s("div",{key:n},[s("div",{staticClass:"table_name"},[e._v("预览名称 "+e._s(e.xlsxInfo.xlsxname)+" - "+e._s(n))]),s("div",{staticClass:"views-box",domProps:{innerHTML:e._s(t)}})])}))],2),s("div",{staticClass:"show-info-box"},[s("div",[e._v(e._s(e.xlsxInfo))])]),s("dzs-code",{attrs:{title:"源代码",value:e.code1}})],1),s("h2",[e._v("源代码下载/查看")]),e._m(0)]),e.newIndex?e._e():s("el-backtop",{attrs:{"visibility-height":20}})],1)}),[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"item"},[s("a",{attrs:{target:"_blank",href:"https://github.com/zsduan/zsduan-summary/blob/master/src/utils/readeXlsx.js"}},[e._v("下载/查看地址")])])}],!1,o,"6c60bb9c",null,null);function o(e){for(var t in l)this[t]=l[t]}e("default",function(){return a.exports}())}}}))}();
