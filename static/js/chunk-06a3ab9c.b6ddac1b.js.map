{"version":3,"sources":["webpack:///./src/views/file-slice-and-merge/file-slice-and-merge.vue?f576","webpack:///./src/views/file-slice-and-merge/file-slice-and-merge.vue","webpack:///./src/utils/file-slice-and-merge.js","webpack:///src/views/file-slice-and-merge/file-slice-and-merge.vue","webpack:///./src/views/file-slice-and-merge/file-slice-and-merge.vue?ef31","webpack:///./src/views/file-slice-and-merge/file-slice-and-merge.vue?b79c"],"names":["render","_vm","this","_c","_self","attrs","staticClass","_v","ref","on","changeFile1","changeFile2","_m","staticRenderFns","fileSliceAndMerge","arg","data","fileId","file","refs","_this","type","fileSize","fileName","isSort","success","result","fail","error","key","Object","hasOwnProperty","call","code","msg","files","$refs","document","querySelector","fileSlice","fileMerge","fileList","i","size","index","parseInt","fileSort","sort","slice","file_name","name","push","length","file_name_arr","forEach","v","map","replace","File","mounted","methods","res","downFile","a","component"],"mappings":"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","file":"static/js/chunk-06a3ab9c.b6ddac1b.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./file-slice-and-merge.vue?vue&type=style&index=0&id=162044ee&prod&lang=less&scoped=true&\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('dzs-header',{attrs:{\"title\":\"vue动态路由\"}}),_c('div',{staticClass:\"page\"},[_c('div',{staticClass:\"tips-box\"},[_vm._v(\"大文件的切片和分割\")]),_c('h2',[_vm._v(\"切片\")]),_c('div',{staticClass:\"item\"},[_c('input',{ref:\"myfile\",attrs:{\"type\":\"file\"},on:{\"change\":_vm.changeFile1}})]),_c('h2',[_vm._v(\"合并\")]),_c('div',{staticClass:\"item\"},[_c('input',{ref:\"myfile1\",attrs:{\"type\":\"file\",\"multiple\":\"\"},on:{\"change\":_vm.changeFile2}})]),_c('h2',[_vm._v(\"源代码下载/查看\")]),_vm._m(0)]),_c('el-backtop',{attrs:{\"visibility-height\":20}})],1)\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"item\"},[_c('a',{attrs:{\"target\":\"_blank\",\"href\":\"https://github.com/zsduan/zsduan-summary/blob/master/src/utils/file-slice-and-merge.js\"}},[_vm._v(\"下载/查看地址\")])])\n}]\n\nexport { render, staticRenderFns }","/*\r\n * @Author: zs.duan\r\n * @Date: 2022-11-25 17:13:14\r\n * @LastEditors: zs.duan\r\n * @LastEditTime: 2022-11-25 18:34:51\r\n * @FilePath: \\vue2+elui+template\\src\\utils\\file-slice-and-merge.js\r\n */\r\n\r\n/*\r\n * @name 文件切片与还原 合并文件要和切片的文件相同\r\n * @parame fileId 读取文件的 id 可选 fileId/file/refs 任选其一\r\n * @parame file 文件本身 可选 fileId/file/refs 任选其一\r\n * @parame refs vue的ref 可选 fileId/file/refs 任选其一\r\n * @parame _this 全局的this指向 refs不为空可选\r\n * @parame type Slice 分片 Merge 合并 \r\n * @parame fileSize 切片大小 默认 5M\r\n * @parame fileName 合并的文件名称\r\n * @parame isSort 合并进行排序\r\n * @method fail 错误返回\r\n * @method success 成功返回 返回数据为下面的数据\r\n * @return { 分片返回\r\n     code : 200,\r\n     fileList : [\r\n        {\r\n            sort : number, //排序\r\n            file : file, //文件bold\r\n            file_name : string ,//文件名称\r\n        }\r\n     ], //文件分片的list数据\r\n     file_name : files.name //文件名称\r\n * }\r\n * @return { 合并返回\r\n     code : 200,\r\n     file : file, //文件 blod数据\r\n     file_name : string //文件名称\r\n * }\r\n*/ \r\n\r\nexport const fileSliceAndMerge = (...arg) =>{\r\n    let data = {\r\n        fileId : \"\",  //读取文件的id\r\n        file : \"\" , //文件\r\n        refs : \"\" ,\r\n        _this : null  , //全局this 指向 指向 Vue\r\n        type : \"slice\", //Slice 分片 Merge 合并\r\n        fileSize : 1024 * 1024 * 5 ,// 切片大小 5M\r\n        fileName : \"\" , //合并文件名称\r\n        isSort : true , //合并是否进行自动排序\r\n        success : (result)=>{} , //读取成功返回\r\n        fail : (error) => {} , //读取失败返回\r\n    }\r\n    for (const key in data) {\r\n        if (Object.hasOwnProperty.call(data, key)) {\r\n            data[key] = arg[0][key] ? arg[0][key] : data[key];\r\n        }\r\n    }\r\n    if(!data.fileId && !data.file && !data.refs){\r\n        data.fail({\r\n            code : -1,\r\n            msg : \"fileId or file or refs must be not null\"\r\n        })\r\n        return ;\r\n    }\r\n    if(data.refs && !data._this){\r\n        data.fail({\r\n            code : -1,\r\n            msg : \"_this must be not null\"\r\n        })\r\n        return ;\r\n    }\r\n    if(!data.type){\r\n        data.fail({\r\n            code : -1,\r\n            msg : \"type must be not null\"\r\n        })\r\n        return ;\r\n    }\r\n    let files = null;\r\n    if(data.refs){\r\n        files = data._this.$refs[data.refs].files\r\n    }\r\n    if(data.fileId){\r\n        files = document.querySelector(`#${data.fileId}`).files;\r\n    }\r\n    if(data.file){\r\n        files = data.file;\r\n    }\r\n    if(data.type == \"slice\"){\r\n        fileSlice(files[0] , data);\r\n    }\r\n    if(data.type == 'merge'){\r\n        fileMerge(files , data)\r\n    }\r\n}\r\n\r\n// 切片\r\nexport const fileSlice = (files , data) =>{\r\n    let fileList = [];\r\n    for(let i = 0 ; i < files.size ; i += data.fileSize){\r\n        let index = parseInt(i / data.fileSize) + 1;\r\n        let fileSort = {\r\n            sort : index,\r\n            file : files.slice(i , data.fileSize * index),\r\n            file_name : `${files.name}-index` \r\n        }\r\n        fileList.push(fileSort);\r\n    }\r\n    data.success({\r\n        code : 200,\r\n        fileList : fileList,\r\n        file_name : files.name\r\n    })\r\n}\r\n\r\n// 合并\r\nexport const fileMerge = (files , data , fileName) =>{\r\n    let fileList = [];\r\n    if(!files.length){\r\n        data.fail({\r\n            code : -1,\r\n            msg : \"files is null\"\r\n        })\r\n        return ;\r\n    }\r\n    if(data.isSort){\r\n        let file_name_arr = []\r\n        for(let i = 0 ; i < files.length ; i ++){\r\n            file_name_arr.push(files[i].name);\r\n        }\r\n        file_name_arr = file_name_arr.sort();\r\n        file_name_arr.forEach(v =>{\r\n            for(let i = 0 ; i < files.length ; i ++){\r\n                if(files[i].name == v){\r\n                    fileList.push(files[i].slice(0 , files[i].size))\r\n                }\r\n            }\r\n        })\r\n    }else{\r\n        fileList = [...files].map((v)=>{\r\n            return v.slice(0 , v.size);\r\n        })\r\n    }\r\n    const name = fileName ? fileName : files[0].name.replace(/-\\d+$/,\"\");\r\n    const file = new File(fileList , name)\r\n    data.success({\r\n        code : 200,\r\n        file : file,\r\n        file_name : name\r\n    })\r\n}\r\n\r\nconst downFile = (v , name) =>{\r\n    const a = document.createElement(\"a\");\r\n    a.setAttribute(\"download\",name);\r\n    a.href = URL.createObjectURL(v);\r\n    a.click();\r\n}","<!--\r\n * @Author: zs.duan\r\n * @Date: 2022-11-25 17:20:17\r\n * @LastEditors: zs.duan\r\n * @LastEditTime: 2022-11-25 18:37:42\r\n * @FilePath: \\vue2+elui+template\\src\\views\\file-slice-and-merge\\file-slice-and-merge.vue\r\n-->\r\n<template>\r\n    <div>\r\n        <dzs-header title=\"vue动态路由\"></dzs-header>\r\n        <div class=\"page\">\r\n            <div class=\"tips-box\">大文件的切片和分割</div>\r\n            <h2>切片</h2>\r\n            <div class=\"item\">\r\n                <input type=\"file\" ref=\"myfile\" @change=\"changeFile1\"/>\r\n                <!-- <dzs-code title=\"源代码\" :value=\"code1\"></dzs-code> -->\r\n            </div>\r\n            <h2>合并</h2>\r\n            <div class=\"item\">\r\n                <input type=\"file\" ref=\"myfile1\" multiple @change=\"changeFile2\"/>\r\n                <!-- <dzs-code title=\"源代码\" :value=\"code1\"></dzs-code> -->\r\n            </div>\r\n            <h2>源代码下载/查看</h2>\r\n            <div class=\"item\">\r\n                <a target=\"_blank\" href=\"https://github.com/zsduan/zsduan-summary/blob/master/src/utils/file-slice-and-merge.js\">下载/查看地址</a>\r\n               \r\n            </div>\r\n        </div>\r\n        <el-backtop :visibility-height=\"20\">\r\n        </el-backtop>\r\n    </div>\r\n</template>\r\n<script>\r\n// import {code1} from \"./config\";\r\nimport {fileSliceAndMerge} from \"@/utils/file-slice-and-merge\"\r\nexport default {\r\n    data(){\r\n        return {\r\n            // code1 : code1\r\n        }\r\n    },\r\n    mounted(){\r\n        \r\n    },\r\n    methods:{\r\n        // 切片\r\n        changeFile1(){\r\n            fileSliceAndMerge({\r\n                refs : \"myfile\",\r\n                _this : this,\r\n                fileSize :1024 * 1024 * 5,\r\n                success : (res)=>{\r\n                    res.fileList.forEach((v ,index) =>{\r\n                        this.downFile(v.file , res.file_name + \"-\" + v.sort);\r\n                    })\r\n                }\r\n            })\r\n        },\r\n        // 合并\r\n        changeFile2(){\r\n            fileSliceAndMerge({\r\n                refs : \"myfile1\",\r\n                _this : this,\r\n                type : \"merge\",\r\n                success : (res)=>{\r\n                    this.downFile(res.file , res.file_name);\r\n                }\r\n            })\r\n        },\r\n        // 下载文件\r\n        downFile(v , name){\r\n            const a = document.createElement(\"a\");\r\n            a.setAttribute(\"download\",name);\r\n            a.href = URL.createObjectURL(v);\r\n            a.click();\r\n        }\r\n    }\r\n}\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.item{\r\n    a{\r\n        margin-left: 10px;\r\n        &:first-child{\r\n            margin-left: 0;\r\n        }\r\n    }\r\n}\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./file-slice-and-merge.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./file-slice-and-merge.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./file-slice-and-merge.vue?vue&type=template&id=162044ee&scoped=true&\"\nimport script from \"./file-slice-and-merge.vue?vue&type=script&lang=js&\"\nexport * from \"./file-slice-and-merge.vue?vue&type=script&lang=js&\"\nimport style0 from \"./file-slice-and-merge.vue?vue&type=style&index=0&id=162044ee&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"162044ee\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}