(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0057aebc"],{"07ab":function(t,e,i){t.exports=i.p+"static/img/2024.f97e1a7b.png"},"150f":function(t,e,i){},"55e5":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"large-screen-page",style:t.backImg},[t.newIndex?t._e():e("dzs-header",{attrs:{title:"大屏抽奖"}}),e("div",{staticClass:"full-screen",on:{click:t.fullScreen}},[e("i",{staticClass:"el-icon-full-screen",style:{"font-size":t.iconSize+"px"}})]),t.isFullScreen?t._e():e("div",{staticClass:"fixed-user-change"},[e("label",{staticClass:"label"},[t._v("内定人员选择")]),e("el-select",{attrs:{filterable:"",multiple:"","collapse-tags":"",placeholder:"请选择"},on:{change:t.changeUser},model:{value:t.fixedIds,callback:function(e){t.fixedIds=e},expression:"fixedIds"}},t._l(t.userList,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id,disabled:t.isWinning}})})),1)],1),e("div",{staticClass:"title"},[t._v(t._s(t.title))]),e("div",{staticClass:"lottery-box"},[1===t.state?e("ul",{staticClass:"public-list"},t._l(t.userList,(function(i,s){return e("li",{key:s},[i.icon?e("div",{staticClass:"icon"},[e("img",{staticClass:"image",attrs:{src:i.icon,alt:""}})]):e("div",{staticClass:"icon",style:{background:i.color,width:t.liWidth,height:t.liWidth}}),e("div",{staticClass:"name"},[t._v(t._s(i.name))]),e("div",{staticClass:"phone"},[t._v(t._s(i.phone))])])})),0):t._e(),2===t.state?e("ul",{staticClass:"public-list"},t._l(t.scrollList,(function(i,s){return e("li",{key:s},[i.icon?e("div",{staticClass:"icon"},[e("img",{staticClass:"image",attrs:{src:i.icon,alt:""}})]):e("div",{staticClass:"icon",style:{background:i.color,width:t.liWidth,height:t.liWidth}}),e("div",{staticClass:"name"},[t._v(t._s(i.name))]),e("div",{staticClass:"phone"},[t._v(t._s(i.phone))])])})),0):t._e(),3===t.state?e("ul",{staticClass:"public-list"},t._l(t.winningList,(function(i,s){return e("li",{key:s},[i.icon?e("div",{staticClass:"icon"},[e("img",{staticClass:"image",attrs:{src:i.icon,alt:""}})]):e("div",{staticClass:"icon",style:{background:i.color,width:t.liWidth,height:t.liWidth}}),e("div",{staticClass:"name"},[t._v(t._s(i.name))]),e("div",{staticClass:"phone"},[t._v(t._s(i.phone))])])})),0):t._e()]),e("div",{staticClass:"footer-box"},[t.isFullScreen?t._e():e("div",{staticClass:"footer-top"},[e("label",{staticClass:"label"},[t._v("中奖人数设置")]),e("el-input-number",{attrs:{min:1,max:50,label:"描述文字"},model:{value:t.winNum,callback:function(e){t.winNum=e},expression:"winNum"}})],1),e("div",{staticClass:"footer-bottom"},[2!==t.state?e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击空格/按钮开始",placement:"top"}},[e("el-button",{attrs:{type:"primary"},on:{click:t.startLottery}},[t._v("开始抽奖")])],1):t._e(),2===t.state?e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击空格/按钮结束",placement:"top"}},[e("el-button",{attrs:{type:"primary"},on:{click:t.stopLottery}},[t._v("停止抽奖")])],1):t._e(),2!==t.state?e("el-button",{attrs:{type:"danger"},on:{click:t.resetLottery}},[t._v("重置")]):t._e()],1)])],1)},n=[],l=(i("14d9"),{name:"large-screen-lottery",props:{newIndex:{type:Boolean,default:()=>!1}},data(){return{backImg:{background:`url(${i("07ab")}) no-repeat`,"background-size":"100% 100%"},userList:[],fixedList:[],fixedIds:[],winningList:[],winnedList:[],scrollList:[],winNum:5,iconSize:30,isFullScreen:!1,title:"XX抽奖",state:1,liWidth:0,timer:null,speed:200}},mounted(){this.randomUser(),window.addEventListener("keydown",t=>{32!==t.keyCode&&"Space"!==t.code||(1===this.state||3===this.state?this.startLottery():2===this.state&&this.stopLottery())})},beforeDestroy(){this.exitFullscreen(),window.removeEventListener("resize",this.getLiWidth),window.removeEventListener("keydown",()=>{})},methods:{randomUser(){let t=[];for(let e=0;e<1e3;e++){let i="#"+Math.floor(16777215*Math.random()).toString(16).padEnd(6,"0"),s={id:e+1,name:"用户"+(e+1),phone:"138"+Math.floor(1e8*Math.random()),isWinning:!1,icon:"",color:i};t.push(s)}this.userList=Object.freeze(t),setTimeout(()=>{this.getLiWidth()},200)},fullScreen(){this.isFullScreen=!this.isFullScreen,this.isFullScreen?(this.iconSize=20,this.requestFullScreen()):(this.iconSize=30,this.exitFullscreen())},exitFullscreen(){let t=document,e=t.cancelFullScreen||t.webkitCancelFullScreen||t.mozCancelFullScreen||t.exitFullScreen;if("undefined"!=typeof e&&e)e.call(t);else if("undefined"!=typeof window.ActiveXObject){let t=new ActiveXObject("WScript.Shell");null!=t&&t.SendKeys("{F11}")}setTimeout(()=>{this.getLiWidth(!0)},200)},requestFullScreen(){let t=document.querySelector(".large-screen-page"),e=t.requestFullScreen||t.webkitRequestFullScreen||t.mozRequestFullScreen||t.msRequestFullScreen;if("undefined"!=typeof e&&e)e.call(t);else if("undefined"!=typeof window.ActiveXObject){let t=new ActiveXObject("WScript.Shell");null!=t&&t.SendKeys("{F11}")}setTimeout(()=>{this.getLiWidth(!0)},200)},startLottery(){let t=this.userList.filter(t=>!1===t.isWinning);this.winNum>t.length?this.$message.error("中奖人数不能超过总人数"):(this.state=2,this.timer=setInterval(()=>{let t=[];for(let e=0;e<this.winNum;e++){let i=Math.floor(Math.random()*this.userList.length),s=this.userList[i],n=this.winnedList.findIndex(t=>t.id===s.id),l=t.findIndex(t=>t.id===s.id);-1==n&&-1==l?t.push(s):e--}this.scrollList=t},this.speed),this.getLiWidth(!0))},resetLottery(){this.winnedList=[],this.state=1,this.fixedList=[],this.winningList=[],this.userList.forEach(t=>t.isWinning=!1)},stopLottery(){clearInterval(this.timer),this.timer=null,this.winningList=[],this.fixedList.length>0&&(this.winningList=this.userList.filter(t=>-1!==this.fixedList.findIndex(e=>e.id===t.id)));let t=this.userList.length<this.winNum?this.userList.length:this.winNum;t-=this.winningList.length;for(let e=0;e<t;e++){let t=Math.floor(Math.random()*this.scrollList.length),i=this.scrollList[t],s=this.winningList.findIndex(t=>t.id===i.id);-1==s?this.winningList.push(i):e--}this.winningList.forEach(t=>{let e=this.userList.findIndex(e=>e.id===t.id);this.userList[e].isWinning=!0,this.winnedList.push(t)}),this.winningList.sort(()=>Math.random()-.5),this.state=3,this.fixedList=[],this.fixedIds=[],this.scrollList=[]},getLiWidth(t=!1){let e=document.querySelector(".public-list li");this.liWidth=e.offsetWidth-100+"px",t||window.addEventListener("resize",()=>{this.isFullScreen?this.liWidth=e.offsetWidth-160+"px":this.liWidth=e.offsetWidth-100+"px"})},changeUser(){if(this.fixedIds.length>this.winNum)return this.$message.error("内定人员不能超过中奖人数"),void(this.fixedIds=this.fixedIds.slice(0,this.winNum));this.fixedList=this.userList.filter(t=>-1!==this.fixedIds.findIndex(e=>e===t.id))}}}),a=l,r=(i("d727"),i("2877")),c=Object(r["a"])(a,s,n,!1,null,"7d88f9e7",null);e["default"]=c.exports},d727:function(t,e,i){"use strict";i("150f")}}]);
//# sourceMappingURL=chunk-0057aebc.d35b1448.js.map